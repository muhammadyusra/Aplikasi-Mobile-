<ion-content class="ios-bg">
  <div class="page-container" #exportArea>

    <!-- HEADER (mirip halaman Pengamatan Hama) -->
    <div class="page-header glass">
      <ion-button fill="clear" (click)="goBack()">
        <ion-icon slot="icon-only" name="arrow-back"></ion-icon>
      </ion-button>
      <h2>Statistik Hama</h2>
      <div class="header-right">
        <div class="date-badge">
          <div class="month">{{ currentMonthName | slice:0:3 }}</div>
          <div class="day">{{ currentYear }}</div>
        </div>
      </div>
    </div>

    <!-- SUMMARY CARD -->
    <section class="card-block">
      <div class="meta small">Dashboard</div>
      <h1 class="page-title">Statistik Hama</h1>
      <p class="muted">Ringkasan bulan ini — data dari catatan hama</p>

      <div class="summary-grid">
        <div class="stat-card">
          <div class="label">Total Laporan</div>
          <div class="value">{{ totalHama }}</div>
        </div>
        <div class="stat-card">
          <div class="label">Jenis Hama</div>
          <div class="value">{{ jumlahJenis }}</div>
        </div>
        <div class="stat-card">
          <div class="label">Bulan Ini</div>
          <div class="value">{{ bulanIni }}</div>
        </div>
        <div class="stat-card accent">
          <div class="label">Kenaikan</div>
          <div class="value">{{ persenKenaikanThisMonth }}%</div>
        </div>
      </div>
    </section>

    <!-- PIE CHART CARD -->
    <section class="card-block chart-card">
      <div class="card-head">
        <h3>Distribusi Jenis Hama</h3>
      </div>
      <div class="card-body">
        <canvas #pieCanvas></canvas>
      </div>
    </section>

    <!-- LINE CHART CARD -->
    <section class="card-block chart-card">
      <div class="card-head">
        <h3>Tren Laporan 12 Bulan</h3>
      </div>
      <div class="card-body">
        <canvas #lineCanvas></canvas>
      </div>
    </section>

    <!-- LAST REPORTS -->
    <section class="card-block list-section">
      <h3 class="section-title">Daftar Hama Terakhir</h3>

      <div class="list">
        <article class="list-item" *ngFor="let h of hamaList">
          <div class="li-left">
            <div class="li-title">{{ h.jenis_hama || h.nama || 'Tanpa Nama' }}</div>
            <div class="li-sub">{{ h.lokasi_blok || '-' }} • {{ h.tanggal_pengamatan | date:'dd MMM yyyy, HH:mm' }}</div>
            <div class="li-note" *ngIf="h.catatan">Catatan: {{ h.catatan }}</div>
          </div>

          <div class="li-right">
            <div class="badge">{{ h.jumlah ?? '-' }}</div>
          </div>
        </article>
      </div>
    </section>

  </div> <!-- /page-container -->
</ion-content>
